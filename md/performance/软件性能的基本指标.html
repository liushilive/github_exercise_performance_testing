<!DOCTYPE HTML>
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>性能测试相关 - 软件性能的基本指标</title>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="" name="description">
<meta content="刘士" name="author">

<link href="../../../asserts/lsbook/less/website.css" rel="stylesheet">
<link href="../../../asserts/lsbook/katex/katex.min.css" rel="stylesheet">
<link href="../../../asserts/lsbook/lightbox/css/lightbox.min.css" rel="stylesheet">

<meta content="true" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<link href="../../../asserts/lsbook/images/apple-touch-icon-precomposed-152.png"
      rel="apple-touch-icon-precomposed" sizes="152x152">
<link href="../../../asserts/lsbook/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
<!--分页-->
<link href="软件性能测试方法论.html" rel="next"/>
</head>
<body>
<div class="book"><div class="book-summary">
    <div id="book-search-input" role="search">
        <input placeholder="输入并搜索" type="text"/>
    </div>
    <nav role="navigation">
        <ul class="summary">
            <li class="header">Summary</li>
<ul class="articles"><li class="chapter" data-level="1.1" data-path="../../index.html"><a href="../../index.html"><b>1.1.</b>介绍</a></li>
<li class="chapter" data-level="1.2" data-path="性能测试类型.html"><a href="性能测试类型.html"><b>1.2.</b>性能测试类型</a></li>
<li class="chapter active" data-level="1.3" data-path="软件性能的基本指标.html"><a href="软件性能的基本指标.html"><b>1.3.</b>软件性能的基本指标</a></li>
<li class="chapter" data-level="1.4" data-path="软件性能测试方法论.html"><a href="软件性能测试方法论.html"><b>1.4.</b>软件性能测试方法论</a></li>
<li class="chapter" data-level="1.5" data-path="性能测试工具.html"><a href="性能测试工具.html"><b>1.5.</b>性能测试工具</a></li>
<li class="chapter" data-level="1.6" data-path="../LR/简介.html"><a href="../LR/简介.html"><b>1.6.</b>LoadRunner 简介</a></li></ul>
            <li class="divider"></li>
            <li>
                <a class="lsbook-link" href="https://github.com/liushilive/lsbook" target="blank">
                    本书使用 LsBook 发布
                </a>
            </li>
        </ul>
    </nav>
</div>

<div class="book-body">
    <div class="body-inner">
    <div class="book-header" role="navigation">
        <!-- Title -->
        <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i>
            <a href="../..">软件性能的基本指标</a>
        </h1>
    </div>

    <div class="page-wrapper" role="main" tabindex="-1">
        <div class="page-inner">
            <div class="search-plus" id="book-search-results">
                <div class="search-noresults">
                    <section class="normal markdown-section">
                        <div id='anchor-navigation-ex-navbar'><i class='fa fa-anchor'></i><ul><li><span class='title-icon fa fa-hand-o-right'></span><a aria-label class='on-toolbar-action' href='' onclick="$('.fa.fa-align-justify').parent()[0].click();">目录</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_1'><b></b>软件性能的基本指标</a></li><ul><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_2'><b>1. </b>业务指标</a></li><ul><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_3'><b>1.1. </b>响应时间 Response Time</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_4'><b>1.2. </b>系统处理能力</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_5'><b>1.3. </b>吞吐量 Throughput</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_6'><b>1.4. </b>并发用户数 Virtual User</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_7'><b>1.5. </b>最大并发用户数</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_8'><b>1.6. </b>PV</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_9'><b>1.7. </b>UV</a></li></ul><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_10'><b>2. </b>资源指标</a></li><ul><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_11'><b>2.1. </b>处理器</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_12'><b>2.2. </b>内存 RAM Memory</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_13'><b>2.3. </b>磁盘 I/O</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_14'><b>2.4. </b>带宽</a></li></ul><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_15'><b>3. </b>其他术语</a></li><ul><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_16'><b>3.1. </b>思考时间</a></li><li><span class='title-icon fa fa-hand-o-right'></span><a href='#anchor_17'><b>3.2. </b>集合点</a></li></ul></ul></ul></div><a href='#anchor_1' id='anchorNavigationExGoTop'><i class='fa fa-arrow-up'></i></a>
                        <h1 id="anchor_1"><a class="anchor-navigation-ex-anchor" href="#anchor_1" name="anchor_1"><i aria-hidden="true" class="fa fa-link"></i></a>软件性能的基本指标</h1>
<p>性能测试指标细分为<code class="language-vim">业务指标</code>、<code class="language-vim">资源指标</code>、<code class="language-vim">应用指标</code>、<code class="language-vim">前端指标</code>。</p>
<ul>
<li>
<p>业务指标</p>
<p>并发用户数、TPS（系统每秒处理事务数）、成功率、响应时间</p>
</li>
<li>
<p>资源指标</p>
<p>CPU 资源利用率、内存利用率、I/O</p>
</li>
<li>
<p>应用指标</p>
<p>空闲线程数、数据库连接数、GC/FULL GC 次数、函数耗时等。</p>
</li>
<li>
<p>前端指标</p>
<p>页面加载时间，网络时间（DNS，连接时间、传输时间等）。</p>
</li>
</ul>
<p>性能测试指标总的可以划分为<code class="language-vim">业务指标</code>和<code class="language-vim">系统资源指标</code>两大部分。对于一般用户而言，对于系统性能的要求主要是<code class="language-vim">业务指标</code>，而<code class="language-vim">系统资源指标</code>是系统性能的一个反应，它可以帮助分析系统性能瓶颈、优化系统或者发现一些隐性问题。</p>
<p>对于业务指标的要求主要是请求<code class="language-vim">响应时间</code>、<code class="language-vim">最大并发量</code>等。</p>
<p>对于系统资源的指标，例如，<code class="language-vim">资源使用率</code>，是指在系统负载运行期间，数据库服务器、应用服务器、Web 服务器的 CPU、内存、硬盘、外置存储、网络带宽的使用率。低于 <code class="language-vim">20%</code> 的使用率为资源<code class="language-vim">空闲</code>，<code class="language-vim">20% ~ 60%</code> 的使用率为资源使用<code class="language-vim">稳定</code>，<code class="language-vim">60% ~ 80%</code> 的使用率表示资源使用<code class="language-vim">饱和</code>，超过 <code class="language-vim">80%</code> 的资源使用率必须尽快进行资源<code class="language-vim">调整</code>和<code class="language-vim">优化</code>。</p>
<h2 id="anchor_2"><a class="anchor-navigation-ex-anchor" href="#anchor_2" name="anchor_2"><i aria-hidden="true" class="fa fa-link"></i></a>1. 业务指标</h2>
<p>业务指标是对软件系统业务处理能力及响应速度的衡量值，是软件系统性能表现的最直观体现。</p>
<p>下面来了解一些性能测试中常见的业务指标。</p>
<h3 id="anchor_3"><a class="anchor-navigation-ex-anchor" href="#anchor_3" name="anchor_3"><i aria-hidden="true" class="fa fa-link"></i></a>1.1. 响应时间 Response Time</h3>
<p>要理解响应时间，首先需引入<code class="language-vim">事务</code>的概念。事务是指用户在客户端做一种或多种业务所需要的<code class="language-vim">操作集</code>。</p>
<p>响应时间就是对事务操作时间的测量。</p>
<p><code class="language-vim">事务响应时间</code> Transaction Response Time 从客户端发起一个请求开始，到客户端接收到从服务器端返回的响应结束，整个过程所耗费的时间。此响应时间不包含客户端 GUI 时间（例如浏览器解释页面所消耗的时间）。</p>
<p>对于软件系统来说，通过事务得到的系统响应时间也是由很多部分组成的。一般来说，响应时间由<code class="language-vim">网络时间</code>、<code class="language-vim">服务器处理时间</code>、<code class="language-vim">网络延迟</code>三大部分组成。首先来看从客户端发出请求到服务器返回需要经历哪些过程。</p>
<p><a data-lightbox="1" href="../../lsbook_import_img/2019-10-03-16-42-42.png"><img src="../../lsbook_import_img/2019-10-03-16-42-42.png" alt="请求与响应流程" title="请求与响应流程" /></a></p>
<ol>
<li>
<p>网络时间</p>
<ul>
<li><code class="language-vim">客户端</code>发出<code class="language-vim">请求</code>首先通过网络来到 <code class="language-vim">Web Server</code> 上（消耗时间为 <code class="language-vim">N1</code>）</li>
<li><code class="language-vim">Web Server</code> 将<code class="language-vim">处理后的请求</code>发送给 <code class="language-vim">App Server</code>（消耗时间为 <code class="language-vim">N2</code>）</li>
<li><code class="language-vim">App Server</code> 将<code class="language-vim">操作数据指令</code>发送给 <code class="language-vim">Database</code>（消耗时间为 <code class="language-vim">N3</code>）</li>
<li><code class="language-vim">Database</code> 将<code class="language-vim">查询结果数据</code>发送回 <code class="language-vim">App Server</code>（消耗时间为 <code class="language-vim">N4</code>）</li>
<li><code class="language-vim">App Server</code> 将<code class="language-vim">处理后的页面</code>发送给 <code class="language-vim">Web Server</code>（消耗时间为 <code class="language-vim">N5</code>）</li>
<li>最后 <code class="language-vim">Web Server</code> 将 <code class="language-vim">HTML</code> 转发到<code class="language-vim">客户端</code>（消耗时间为 <code class="language-vim">N6</code>）</li>
</ul>
<p>这里的 <code class="language-vim">Nx</code> 都是网络传输上的<code class="language-vim">时间开销</code>，没有计算业务处理所需要花费的时间。</p>
</li>
<li>
<p>服务器处理时间</p>
<p>另外还要考虑各个服务器处理所需要的时间 <code class="language-vim">WT</code>、<code class="language-vim">AT</code>、<code class="language-vim">DT</code>。</p>
</li>
<li>
<p>网络延迟</p>
<p>除了上面两种时间开销，还要考虑<code class="language-vim">网络延迟</code>的问题。</p>
</li>
</ol>
<p>所以最终的响应时间组成为：</p>
<p><code class="language-vim">响应时间 = 网络延迟时间 + WT+AT+DT + N1+N2+N3 + N4+N5+N6 + WT+AT+DT</code></p>
<ul>
<li>
<p>参考标准</p>
<p>不同行业不同业务可接受的响应时间是不同的，一般情况，对于在线实时交易：</p>
<ul>
<li>互联网企业：<code class="language-vim">500</code> 毫秒以下，例如淘宝业务 <code class="language-vim">10</code> 毫秒左右。</li>
<li>金融企业：<code class="language-vim">1</code> 秒以下为佳，部分复杂业务 <code class="language-vim">3</code> 秒以下。</li>
<li>保险企业：<code class="language-vim">3</code> 秒以下为佳。</li>
<li>制造业：<code class="language-vim">5</code> 秒以下为佳。</li>
</ul>
</li>
</ul>
<h3 id="anchor_4"><a class="anchor-navigation-ex-anchor" href="#anchor_4" name="anchor_4"><i aria-hidden="true" class="fa fa-link"></i></a>1.2. 系统处理能力</h3>
<p>系统处理能力是指系统在利用系统硬件平台和软件平台进行信息处理的能力。</p>
<p>系统处理能力通过<code class="language-vim">系统每秒钟能够处理的交易数量</code>来评价，交易有两种理解：</p>
<ul>
<li>一是业务人员角度的一笔业务过程；</li>
<li>二是系统角度的一次交易申请和响应过程。</li>
</ul>
<p>前者称为<code class="language-vim">业务交易过程</code>，后者称为<code class="language-vim">事务</code>。两种交易指标都可以评价应用系统的处理能力。一般的建议与系统交易日志保持一致，以便于统计业务量或者交易量。系统处理能力指标是技术测试活动中重要指标。</p>
<p>一般情况下，用以下几个指标来度量：</p>
<ul>
<li>
<p>HPS（Hits Per Second）：点击率。每秒点击次数，单位是<code class="language-vim">次/秒</code></p>
<p>HPS 主要指每秒客户端向 Web 服务器提交的 HTTP 请求数。客户端每发送一个请求，服务器就处理一次，所以点击数是 Web 应用处理交易的最小单位。HPS 越大，对服务器的压力相对也越大。</p>
<p>这里需要区别的是，点击不是指日常使用鼠标的<code class="language-vim">单击</code>操作，因为在一次<code class="language-vim">单击</code>操作中，客户端可能向服务器发起了多个 HTTP 请求。</p>
<p>HPS 除受程序处理速度的影响，还受带宽的限制，即每个请求的大小情况。请求越小，每秒完成的请求数越多。在排除带宽影响的情况下，具有缓存机制的系统比没有缓存机制的系统 HPS 要高很多。在网络传输到达一定程度后，HPS 就不会随并发量的增长而增大。</p>
<p>一般可以在限定的带宽情况下对最大 HPS 进行估算，公式如下：</p>
<p><code class="language-vim">最大HPS = 带宽 / 8 / 估算平均每个请求大小</code></p>
<p>带宽好比公路的宽度，网速好比车流的速度。带宽基本单位<code class="language-vim">比特</code>，简写为小写字母<code class="language-vim">b</code>，更大的单位是：<code class="language-vim">Kb</code>、<code class="language-vim">Mb</code>、<code class="language-vim">Gb</code> 等；网速基本单位<code class="language-vim">字节</code>，简写为大写字母<code class="language-vim">B</code>，更大的单位有：<code class="language-vim">KB</code>、<code class="language-vim">MB</code>、<code class="language-vim">GB</code> 等。</p>
<p><code class="language-vim">100Mb / 8 / 5KB = 12.5MB / 5KB = 12.5 * 1024 / 5 = 2560</code></p>
<p>一般来说，日访问量是在 HPS 基础上计算出来的，公式如下：</p>
<p><code class="language-vim">日访问量 = HPS * 3600 * 日访问小时数（可按 8 小时算）</code></p>
</li>
<li>
<p>QPS（Queries per Second）：系统每秒处理查询次数，单位是<code class="language-vim">次/秒</code></p>
<p><code class="language-vim">每秒查询率</code>，是一台服务器每秒能够响应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。它代表的是服务器的机器的性能最大吞吐能力。</p>
</li>
<li>
<p>TPS（Transaction per Second）：系统每秒处理交易数，单位是<code class="language-vim">笔/秒</code></p>
<p><code class="language-vim">TPS= 脚本运行期间所有事务总数 / 脚本运行时长</code></p>
<p>TPS 反映了系统在同一时间内能够处理业务的最大能力。TPS 会受到负载的影响，也会随着负载的增加而逐渐增加。当系统进入繁忙期后，TPS 会有所下降，而在几分钟后开始出现少量的失败事务。</p>
</li>
</ul>
<p>对于互联网业务中，如果某些业务有且仅有一个请求连接，那么 <code class="language-vim">TPS=QPS=HPS</code>，一般情况下用 TPS 来衡量整个业务流程，用 QPS 来衡量接口查询次数，用 HPS 来表示对服务器点击请求。</p>
<ul>
<li>
<p>参考标准</p>
<p>无论 TPS、QPS、HPS, 此指标是衡量系统处理能力非常重要的指标，越大越好。</p>
<p>对于已上线系统：可选取高峰时刻，在一定时间内（如 3-10 分钟），获取系统总业务量，计算单位时间（秒）内完成的笔数，乘以 2-5 倍作为峰值的 TPS，例如峰值 3 分钟内处理订单 18 万笔，平均 TPS 是 1000，峰值 TPS 可以是 2000-5000。</p>
<p>对于新系统：没有历史数据作参考，建议通过业务部门进行评估。根据经验，一般情况下：</p>
<ul>
<li>金融行业：<code class="language-vim">1K</code>TPS ~ <code class="language-vim">5W</code>TPS，不包括互联网化的活动</li>
<li>保险行业：<code class="language-vim">100</code>TPS ~ <code class="language-vim">10W</code>TPS，不包括互联网化的活动</li>
<li>制造行业：<code class="language-vim">10</code>TPS ~ <code class="language-vim">5K</code>TPS</li>
<li>互联网电子商务：<code class="language-vim">1W</code>TPS ~ <code class="language-vim">100W</code>TPS</li>
<li>互联网中型网站：<code class="language-vim">1K</code>TPS ~ <code class="language-vim">5W</code>TPS</li>
<li>互联网小型网站：<code class="language-vim">500</code>TPS ~ <code class="language-vim">1W</code>TPS</li>
</ul>
<p>TPS 可以参照同行业系统和结合具体业务，中小企业 TPS 值为 <code class="language-vim">50 ~ 1K 笔/秒</code>，银行 TPS 值为 <code class="language-vim">1K ~ 5W 笔/秒</code>，淘宝 TPS 值为 <code class="language-vim">3W~30W 笔/秒</code>。</p>
</li>
</ul>
<h3 id="anchor_5"><a class="anchor-navigation-ex-anchor" href="#anchor_5" name="anchor_5"><i aria-hidden="true" class="fa fa-link"></i></a>1.3. 吞吐量 Throughput</h3>
<p>吞吐量为<code class="language-vim">单位时间内系统处理的客户请求的数量</code>，直接体现软件系统的性能承载能力。</p>
<p>对于交互式应用系统来说，吞吐量反映的是服务器承受的压力；在容量规划的测试中，吞吐量是一个重要指标，它不但反映在中间件、数据库上，更加体现在硬件上。</p>
<ul>
<li>从业务角度看，吞吐量可用<code class="language-vim">请求数/秒</code>、<code class="language-vim">页面数/秒</code>、<code class="language-vim">人数/天</code>或<code class="language-vim">处理业务数/小时</code>等单位来衡量；</li>
<li>从网络角度看，吞吐量可以用<code class="language-vim">字节/秒</code>来衡量。</li>
</ul>
<p>对于交互式应用来说，吞吐量反映的是服务器承受的压力，它能够说明系统的负载能力。</p>
<p>以不同方式表达的吞吐量可以说明不同层次的问题。</p>
<p>例如：</p>
<ul>
<li>以<code class="language-vim">字节/秒</code>的方式，可以表示要受网络基础设施、服务器架构、应用服务器制约等方面的瓶颈；</li>
<li>以<code class="language-vim">请求数/秒</code>的方式，表示主要是受应用服务器和应用代码的制约体现出的瓶颈。</li>
</ul>
<p>经常在网上看到<code class="language-vim">吞吐量</code>与<code class="language-vim">吞吐率</code>的概念，也有不少人把两者混淆。</p>
<ul>
<li><code class="language-vim">吞吐量</code>是指单位时间内系统处理的请求数量，能直接反映服务器承受的压力，是需要重点关注的指标。</li>
<li><code class="language-vim">吞吐率</code>一般指用户在给定的一秒内从服务器获得的数据量，简而言之就是服务器返回的数据量。</li>
</ul>
<h3 id="anchor_6"><a class="anchor-navigation-ex-anchor" href="#anchor_6" name="anchor_6"><i aria-hidden="true" class="fa fa-link"></i></a>1.4. 并发用户数 Virtual User</h3>
<p>首先来理解一下并发的概念。</p>
<ol>
<li>
<p>并发的两种情况</p>
<p>一种是严格意义上的并发，即<code class="language-vim">所有的用户在同一时刻做同一件事或操作</code>，这种操作一般指做同一类型的业务。</p>
<p>例如，所有用户同一时刻做并发登录，同一时刻做表单提交。</p>
<p>另一种并发是广义范围的并发，这种并发与前一种并发的区别是，尽管多个用户对系统发出了请求或者进行了操作，但是这些请求或者操作可以是相同的，也可以是不同的。</p>
<p>例如，在同一时刻有用户在登录，有用户在提交表单。</p>
</li>
<li>
<p>从服务器的角度来看并发</p>
<p>前面的两种解释都是从用户业务的角度来解释并发的，因为我们平时所做的性能测试也是从用户端对业务层的操作来进行并发测试的。</p>
<p>如果考虑整个系统运行过程中服务器所承受的压力，则并发是这样的：在该系统的运行过程中，把整个运行过程划分为离散的时间点，在每个点上都有一个<code class="language-vim">同时向服务器端发送请求的客户数</code>，这就是所谓的服务器所承受的最大并发访问数。</p>
</li>
<li>
<p>并发用户数与系统用户数、在线用户数的区别</p>
<ul>
<li>系统用户数：简单地说就是该系统的注册用户数</li>
<li>在线用户数：即登录系统的用户</li>
<li>并发用户数：是对服务器产生压力的用户</li>
</ul>
<p>例如一个邮件系统，有 100 个注册用户，那么<code class="language-vim">系统用户数</code>就是 100 个；其中一段时间内有 80 个用户登录使用，在这段时间内<code class="language-vim">在线用户数</code>就是 80。</p>
<p>但其中有 10 个用户在阅读邮件内容，20 个用户在写邮件，这 30 个用户在此阶段对服务器并没有产生压力。只有产生了请求、提交等业务操作的用户才会对服务器构成压力。</p>
<p>所以<code class="language-vim">并发用户数</code>是指在系统运行期间同一时刻进行业务操作的用户数量。一般应用系统并发用户数为在线用户数的 <code class="language-vim">10%~20%</code>，但还是要取决于具体的业务逻辑、业务场景。</p>
</li>
</ol>
<h3 id="anchor_7"><a class="anchor-navigation-ex-anchor" href="#anchor_7" name="anchor_7"><i aria-hidden="true" class="fa fa-link"></i></a>1.5. 最大并发用户数</h3>
<p>最大并发用户数是指应用系统在正式环境下所能承受的最大并发用户数量。</p>
<p>在运行中，如果出现了频繁业务操作失败、响应时间远远超出用户所能承受的最大值或出现了服务器宕机等情况，则说明系统承载量已经超出了最大并发用户数的范围。</p>
<ul>
<li>
<p>先了解一个而简单的例子</p>
<p><code class="language-vim">TPS</code> 是<code class="language-vim">每秒事务数</code>，但是事务时要靠虚拟用户做出来的，假如 <code class="language-vim">1</code> 个虚拟用户在 <code class="language-vim">1</code> 秒内完成 <code class="language-vim">1</code> 笔事务，那么 <code class="language-vim">TPS</code> 明显就是 <code class="language-vim">1</code>；</p>
<p>如果某笔业务响应时间是 <code class="language-vim">1ms</code>, 那么 <code class="language-vim">1</code> 个用户在 <code class="language-vim">1</code> 秒内能完成 <code class="language-vim">1000</code> 笔事务，<code class="language-vim">TPS</code> 就是 <code class="language-vim">1000</code> 了；</p>
<p>如果某笔业务响应时间是 <code class="language-vim">1s</code>, 那么 <code class="language-vim">1</code> 个用户在 <code class="language-vim">1</code> 秒内只能完成 <code class="language-vim">1</code> 笔事务，要想达到 <code class="language-vim">1000TPS</code>，至少需要 <code class="language-vim">1000</code> 个用户；</p>
</li>
</ul>
<p>因此可以说 <code class="language-vim">1</code> 个用户可以产生 <code class="language-vim">1000TPS</code>，<code class="language-vim">1000</code> 个用户也可以产生 <code class="language-vim">1000TPS</code>，无非是看响应时间快慢。</p>
<p>系统的性能由 <code class="language-vim">TPS</code> 决定，跟并发用户数没有多大关系。系统的最大 <code class="language-vim">TPS</code> 是一定的（在一个范围内），但并发用户数不一定，可以调整。</p>
<ul>
<li>
<p>对于已有系统</p>
<p>可选取高峰时刻，在一定时间内使用系统的人数，这些人数可认为是在线用户数，并发用户数可以取 <code class="language-vim">10%</code>。</p>
<p>例如在半个小时内，使用系统的用户数为 <code class="language-vim">10</code> 万，那么取 <code class="language-vim">10%</code>（即 <code class="language-vim">1</code> 万）作为并发用户数基本就够了。</p>
</li>
<li>
<p>新系统</p>
<p>没有历史数据作参考，建议通过业务部门进行评估。</p>
<p>一般情况下，大型系统（业务量大、机器多）做压力测试，<code class="language-vim">1W ~ 5W</code> 个用户并发，中小型系统做压力测试，<code class="language-vim">5K</code> 个用户并发比较常见。</p>
</li>
</ul>
<h3 id="anchor_8"><a class="anchor-navigation-ex-anchor" href="#anchor_8" name="anchor_8"><i aria-hidden="true" class="fa fa-link"></i></a>1.6. PV</h3>
<p><code class="language-vim">PV</code> 即 page view，页面浏览量。</p>
<p>用户每一次对网站中的每个页面访问均被记录 1 次。用户对同一页面的多次刷新，访问量累计。通常是衡量一个网站甚至一条网络新闻的主要指标。</p>
<p>与 <code class="language-vim">PV</code> 相关的还有 <code class="language-vim">RV</code>，即<code class="language-vim">重复访问者数量</code>（repeat visitors）。</p>
<h3 id="anchor_9"><a class="anchor-navigation-ex-anchor" href="#anchor_9" name="anchor_9"><i aria-hidden="true" class="fa fa-link"></i></a>1.7. UV</h3>
<p><code class="language-vim">UV</code> 访问数（Unique Visitor）指<code class="language-vim">独立访客访问数</code>，统计 1 天内访问某站点的用户数（以 cookie 为依据），一台电脑终端为一个访客。</p>
<p>可以理解成访问某网站的电脑的数量。网站判断来访电脑的身份是通过来访电脑的 cookies 实现的。如果更换了 IP 后但不清除 cookies，再访问相同网站，该网站的统计中 UV 数是不变的。如果用户不保存 cookies 访问、清除了 cookies 或者更换设备访问，计数会加 1。一天内相同的客户端多次访问只计为 1 个访客。</p>
<h2 id="anchor_10"><a class="anchor-navigation-ex-anchor" href="#anchor_10" name="anchor_10"><i aria-hidden="true" class="fa fa-link"></i></a>2. 资源指标</h2>
<p>资源指标与硬件资源消耗直接相关，也就是所谓的<code class="language-vim">资源利用率</code>。测试的目的不同，需要统计的系统资源指标也不同，主要包括服务器操作系统资源使用情况、资源消耗情况等。</p>
<h3 id="anchor_11"><a class="anchor-navigation-ex-anchor" href="#anchor_11" name="anchor_11"><i aria-hidden="true" class="fa fa-link"></i></a>2.1. 处理器</h3>
<ol>
<li>
<p><code class="language-vim">CPU 占用率</code>：<code class="language-vim">CPU Utilization</code> Linux</p>
<p><code class="language-vim">CPU 利用率</code> : <code class="language-vim">Processor/Processor Time</code></p>
<p>如果该值持续超过 <code class="language-vim">95%</code>，则表明瓶颈是 CPU。可以考虑增加一个处理器或更换一个更快的处理器。一般可接受的最大上限是 <code class="language-vim">80%~85%</code>，合理使用的范围在 <code class="language-vim">60%~70%</code> 以下。</p>
</li>
<li>
<p><code class="language-vim">处理器队列长度</code>：<code class="language-vim">System/Processor Queue Length</code></p>
<p>如果 <code class="language-vim">System/Processor Queue Length</code> 大于 2，而<code class="language-vim">处理器利用率</code>（Processor Time）一直很低，则存在着处理器阻塞。</p>
<p>CPU 资源成为系统性能瓶颈的征兆：</p>
<ul>
<li>很慢的响应时间（slow response time）。</li>
<li>CPU 空闲时间为零（zero Percent idle CPU）。</li>
<li>过高的用户占用 CPU 时间（high Percent user CPU）。</li>
<li>过高的系统占用 CPU 时间（high Percent system CPU）。</li>
<li>长时间的有很长的运行进程队列（large run queue size sustained over time）。</li>
</ul>
</li>
</ol>
<h3 id="anchor_12"><a class="anchor-navigation-ex-anchor" href="#anchor_12" name="anchor_12"><i aria-hidden="true" class="fa fa-link"></i></a>2.2. 内存 RAM Memory</h3>
<ol>
<li>
<p><code class="language-vim">内存页交换速率</code>：<code class="language-vim">Paging Rate</code> Linux</p>
<p>如果该值偶尔走高，则表明当时有线程竞争内存。</p>
<p>如果该值持续很高，则内存可能是瓶颈，也可能是内存访问命中率低。</p>
</li>
<li>
<p><code class="language-vim">可用字节数</code>：<code class="language-vim">Memory/Available Bytes</code></p>
<p><code class="language-vim">Memory/Available Bytes</code> 计数器的值持续降低，同时 <code class="language-vim">Process/Private Bytes</code> 计数器和 <code class="language-vim">Process/Working Set</code> 计数器的值在长时间内持续升高，则很可能存在内存泄漏。需要更详细的内存监控工具来定位是否有内存泄漏和存在内存泄漏的代码。</p>
<p>内存资源成为系统性能瓶颈的征兆：</p>
<ul>
<li>很高的换页率（high pageout rate）。</li>
<li>进程进入不活动状态。</li>
<li>交换区所有磁盘的活动次数很高。</li>
<li>很高的全局系统 CPU 利用率。</li>
<li>内存不够出错（out of memory）。</li>
</ul>
</li>
</ol>
<h3 id="anchor_13"><a class="anchor-navigation-ex-anchor" href="#anchor_13" name="anchor_13"><i aria-hidden="true" class="fa fa-link"></i></a>2.3. 磁盘 I/O</h3>
<ol>
<li>
<p><code class="language-vim">Disk Rate</code>：<code class="language-vim">磁盘交换率</code> Linux</p>
<p>如果该参数值一直很高，则表明 I/O 有问题。可考虑更换更快的硬盘系统。</p>
</li>
<li>
<p><code class="language-vim">LogicalDisk/Disk Time</code> 和 <code class="language-vim">LogicalDisk/Avg.Disk Queue Length</code></p>
<p>当这两个值很高，而 <code class="language-vim">Page Reads/sec</code>（页面读取操作速率）很低时，则可能存在磁盘瓶颈。</p>
<p>I/O 资源成为系统性能瓶颈的征兆：</p>
<ol>
<li>过高的磁盘利用率（high disk utilization）。</li>
<li>太长的磁盘等待队列（large disk queue length）。</li>
<li>等待磁盘 I/O 的时间所占的百分率太高（large Percentage of time waiting for disk I/O）。</li>
<li>太长的运行进程队列，但 CPU 却空闲（large run queue with idle CPU）。</li>
<li>太高的物理 I/O 速率 [large physical I/O rate（not sufficient in itself）]。</li>
<li>过低的缓存命中率 [low buffer cache hit ratio（not sufficient in itself）]。</li>
</ol>
</li>
</ol>
<h3 id="anchor_14"><a class="anchor-navigation-ex-anchor" href="#anchor_14" name="anchor_14"><i aria-hidden="true" class="fa fa-link"></i></a>2.4. 带宽</h3>
<p>一般使用计数器 <code class="language-vim">Bytes Total/sec</code> 来度量。<code class="language-vim">Bytes Total/sec</code> 表示为发送和接收字节的速率，包括帧字符在内。判断网络连接速度是否是瓶颈，可以用该计数器的值和目前网络的带宽进行比较。</p>
<p>判断网络带宽是否是系统运行性能瓶颈的首要条件是，网络带宽是否会影响系统交易执行性能。</p>
<p>例如，减小网络带宽，并发用户数、响应时间与事务通过率等性能指标是否不能接受；增加网络带宽，并发用户数、响应时间与事务通过率等性能指标会得到明显提高。</p>
<p>在实际性能测试中，如果发现始终报连接超时，而实际手工访问可以正常访问，可以通过 ping 应用服务器 IP 或网关 IP，如果出现网络严重延迟或丢包，则说明网络不稳定，需要检查网络。</p>
<h2 id="anchor_15"><a class="anchor-navigation-ex-anchor" href="#anchor_15" name="anchor_15"><i aria-hidden="true" class="fa fa-link"></i></a>3. 其他术语</h2>
<h3 id="anchor_16"><a class="anchor-navigation-ex-anchor" href="#anchor_16" name="anchor_16"><i aria-hidden="true" class="fa fa-link"></i></a>3.1. 思考时间</h3>
<p>思考时间可以从两个宏观的角度来理解。</p>
<ol>
<li>
<p>思考时间就是用户进行操作时，每个请求或者操作之间的间隔时间，是为了更加真实地模拟用户的操作场景。因为在实际使用中不太可能会出现不断地发送请求，一般都是一个请求后，等待一段时间，然后发送下一个请求，恶意攻击除外。</p>
</li>
<li>
<p>论坛连续发帖时会提示<code class="language-vim">两次发帖时间间隔不能小于 15 秒钟</code>，这时如果要满足业务的特定需求就需要加上思考时间 <code class="language-vim">15s</code> 了。</p>
</li>
</ol>
<p>如果想了解系统的最大承受能力或者极端情况下系统的性能表现，则可以设置为 <code class="language-vim">0</code> 思考时间。但如果是预估系统的性能，就应该最大可能地模拟真实思考时间。一般都会加上思考时间，只是在分析时要去掉思考时间。</p>
<h3 id="anchor_17"><a class="anchor-navigation-ex-anchor" href="#anchor_17" name="anchor_17"><i aria-hidden="true" class="fa fa-link"></i></a>3.2. 集合点</h3>
<p>一般应用于考察单一事务处理能力时应用，比如抢购前，需要等待用户全部登录完毕，就可以插入一个集合点指示所有用户在登录完毕后，等待一起点击抢购按钮。</p>

                        <footer class="page-footer"><span class="copyright">© 2019 刘士. 
All rights reserved.</span><span class="footer-modification">
<span id="busuanzi_container_site_uv" style="display:none">本站访客数 <span id="busuanzi_value_site_uv">
</span> 人次</span></span></footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script>

</script>
                    </section>
                </div>
                <div class="search-results">
                    <div class="has-results">
                        <h1 class="search-results-title"><span class='search-results-count'></span> 结果匹配 "<span class='search-query'></span>"</h1>
                        <ul class="search-results-list"></ul>
                    </div>
                    <div class="no-results">
                        <h1 class="search-results-title">没有匹配的结果 "<span class='search-query'></span>"</h1>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<a aria-label="Previous page: 性能测试类型" class="navigation navigation-prev" href="性能测试类型.html">
    <i class="fa fa-angle-left"></i>
</a>


<a aria-label="Next page: 软件性能测试方法论" class="navigation navigation-next" href="软件性能测试方法论.html">
    <i class="fa fa-angle-right"></i>
</a>


</div>
<script>
    var lsbook = lsbook || [];
    lsbook.push(function () {
        lsbook.page.hasChanged({
            "config": {
                "github_url":"https://liushilive.github.io/",
                "language": "zh-cn",
                "previous_page_link": "性能测试类型.html",
                "next_page_link": "软件性能测试方法论.html"
            },
            "basePath": "../..",
            "js": {'prism': ['../../../asserts/lsbook/prismjs/clipboard.min.js', '../../../asserts/lsbook/prismjs/prism.js']}
        });
    });
</script>
</div>

<script src="../../../asserts/lsbook/jquery-3.3.1.min.js"></script>
<script charset="UTF-8" src="../../../asserts/lsbook/jquery_mar/jquery.mark.js"></script>
<script src="../../../asserts/lsbook/lightbox/js/lightbox.min.js"></script>
<script src="../../../asserts/lsbook/lsbook.min.js"></script>

</body>
</html>
